using Nijo.Util.CodeGenerating;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Nijo.IntegrationTest.DataPatternsClass {
    public class _018_CommandModel_STEP属性つき : DataPatternFromXml {
        public _018_CommandModel_STEP属性つき() : base("018_CommandModel_STEP属性つき.xml") { }

        protected override string AppTsxCustomizer(CodeRenderingContext ctx) {
            return $$"""
                import React from 'react'
                import { DefaultNijoApp, VForm2 } from './__autoGenerated'
                import * as Icon from '@heroicons/react/24/outline'
                import * as Input from './__autoGenerated/input'
                import * as Hooks from './__autoGenerated/autogenerated-hooks'
                import * as Types from './__autoGenerated/autogenerated-types'
                import * as Comps from './__autoGenerated/autogenerated-components'
                import * as RefTo from './__autoGenerated/ref-to'
                import useEvent from 'react-use-event-hook'

                function App() {
                  return (
                    <DefaultNijoApp
                      applicationName="{{ctx.Config.RootNamespace.Replace("\"", "&quot;")}}"
                      uiCustomizer={uiCustomizer}
                    />
                  )
                }

                // 自動生成されたソースコードに任意の処理やUIを追加編集する場合はここで設定してください。
                const uiCustomizer: Types.UiCustomizer = defaultUi => ({
                  ...defaultUi,
                  従業員MultiView: {
                    ...defaultUi.従業員MultiView,
                    HeaderComponent: ({ getSelectedItems }) => {
                      const openCommandDialog = Comps.use従業員データ一括取り込みDialog()
                      const handleClick = useEvent(() => {
                        const items = getSelectedItems()
                        openCommandDialog({ これは最初の画面です: { 取込ファイル: items.map(x => x.values.名前).join(',') } })
                      })
                      return (
                        <Input.IconButton onClick={handleClick}>コマンド</Input.IconButton>
                      )
                    },
                  },
                  RefTo部署SearchCondition: ({ value, onChange, displayName }) => {
                    const openDialog = RefTo.use部署SearchDialog()
                    const handleClick = useEvent(() => {
                      openDialog({
                        onSelect: selectedItem => onChange({
                          部署ID: selectedItem?.部署ID,
                          部署名: selectedItem?.部署名,
                        })
                      })
                    })
                    return (
                      <VForm2.Item label={displayName}>
                        <div className="flex gap-1">
                          <Input.Word className="w-8" value={value?.部署ID} />
                          <Input.IconButton icon={Icon.MagnifyingGlassIcon} onClick={handleClick} outline mini hideText>検索</Input.IconButton>
                          <Input.Word className="flex-1" value={value?.部署名} readOnly />
                        </div>
                      </VForm2.Item>
                    )
                  },
                  RefTo部署: ({ value, onChange, readOnly, displayName, required }) => {
                    const openDialog = RefTo.use部署SearchDialog()
                    const handleClick = useEvent(() => {
                      openDialog({ onSelect: selectedItem => onChange(selectedItem) })
                    })
                    return (
                      <VForm2.Item label={<>
                        <VForm2.LabelText>{displayName}</VForm2.LabelText>
                        {required && <Input.RequiredChip />}
                      </>}>
                        <div className="flex gap-1">
                          <Input.Word className="w-8" value={value?.部署ID} />
                          {!readOnly && (
                            <Input.IconButton icon={Icon.MagnifyingGlassIcon} onClick={handleClick} outline mini hideText>検索</Input.IconButton>
                          )}
                          <Input.Word className="flex-1" value={value?.部署名} readOnly />
                        </div>
                      </VForm2.Item>
                    )
                  },
                })

                export default App
                """;
        }
    }
}
